fatorial3K<-data.frame(resp=c(868,	319,
                              951,	521,
                              694,	868,
                              972,	486,
                              1319,1139,
                              812,868,
                              951,1076,
                              1493,1146,
                              1076,1215,
                              
                              625,	764,
                              1319	,1042,
                              1042,	729,
                              729,	833,
                              764	,1215,
                              806,	625,
                              1285	,604,
                              972,	1153,
                              1042	,729,
                              
                              465,	1181,
                              833,	729,
                              1069,660,
                              1215	,937,
                              729,	1083,
                              660,	625,
                              1076	,972,
                              1250,	1139,
                              1076	,1264
                              
))
str(fatorial3K)

Y<-c(868,	319,
     951,	521,
     694,	868,
     972,	486,
     1319,1139,
     812,868,
     951,1076,
     1493,1146,
     1076,1215,
     
     625,	764,
     1319	,1042,
     1042,	729,
     729,	833,
     764	,1215,
     806,	625,
     1285	,604,
     972,	1153,
     1042	,729,
     
     465,	1181,
     833,	729,
     1069,660,
     1215	,937,
     729,	1083,
     660,	625,
     1076	,972,
     1250,	1139,
     1076	,1264
     
)

dados<-matrix(Y,ncol=2, byrow = T)
dados1<-dados[1:9,]
dados2<-dados[10:18,]
dados3<-dados[19:27,]

correcao<- (sum(Y)^2)/length(Y)
SQTOTAL<-sum(Y^2) - correcao
T.i<-apply(dados, 1,sum)
sum(c(16774,16287,16963)^2)/18
correcaotrat<-(16774^2 + 16278^2 + 16963^2)/18 #???? 18 ou 27
SQTRAT<-sum(T.i^2)/2 - correcaotrat
D.i<-c(apply(dados1, 2,sum),apply(dados2, 2,sum),apply(dados3, 2,sum))

SQBLOCOS<- sum(D.i^2)/9 - correcao

SQRES<-SQTOTAL-SQTRAT-SQBLOCOS


SQN<-sum(c(14679,15817,19519)^2)/18 - correcao
SQP<-sum(c(15358,18797,15860)^2)/18 - correcao
SQK<-sum(c(17887,15693,16435)^2)/18 - correcao


SQNP<-sum(c(4222,5395,5062,5172,6249,4396,5964,7153,6402)^2)/6 - correcao - SQN - SQP
SQNK<-sum(c(5277,6041,6569,4513,4722,6458,4889,5054,6492)^2)/6 - correcao - SQN - SQK 
SQPK<-sum(c(5228,7208,5451,4895,6180,4618,5235,5409,5791)^2)/6 - correcao - SQP - SQK 

SQNPK<-SQTRAT-SQNP-SQNK-SQPK-SQN-SQP-SQK

c1<-c(-1,0,1)
c2<-c(1,-2,1)

N<-c(14679,15817,19519)

SQNLI<-((c1%*%N)^2) / (2*sum(c1^2))
SQN2<-((t(c2)%*%N)^2) / (2*sum(c2^2))


P<-c(15358,18797,15860)
SQPLI<-((c1%*%P)^2) / (2*sum(c1^2))
